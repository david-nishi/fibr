(function(e){function t(t){for(var i,n,o=t[0],u=t[1],c=t[2],d=0,m=[];d<o.length;d++)n=o[d],Object.prototype.hasOwnProperty.call(a,n)&&a[n]&&m.push(a[n][0]),a[n]=0;for(i in u)Object.prototype.hasOwnProperty.call(u,i)&&(e[i]=u[i]);l&&l(t);while(m.length)m.shift()();return r.push.apply(r,c||[]),s()}function s(){for(var e,t=0;t<r.length;t++){for(var s=r[t],i=!0,o=1;o<s.length;o++){var u=s[o];0!==a[u]&&(i=!1)}i&&(r.splice(t--,1),e=n(n.s=s[0]))}return e}var i={},a={app:0},r=[];function n(t){if(i[t])return i[t].exports;var s=i[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=i,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(s,i,function(t){return e[t]}.bind(null,i));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],u=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var l=u;r.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"034f":function(e,t,s){"use strict";var i=s("85ec"),a=s.n(i);a.a},"039a":function(e,t,s){"use strict";var i=s("7174"),a=s.n(i);a.a},"080e":function(e,t,s){"use strict";var i=s("8453"),a=s.n(i);a.a},"18ec":function(e,t,s){"use strict";var i=s("efb1"),a=s.n(i);a.a},1949:function(e,t,s){},"1be2":function(e,t,s){"use strict";var i=s("faf5"),a=s.n(i);a.a},"231f":function(e,t,s){},2497:function(e,t,s){"use strict";var i=s("89f6"),a=s.n(i);a.a},2742:function(e,t,s){},"3a7b":function(e,t,s){},4906:function(e,t,s){},"4bc9":function(e,t,s){"use strict";var i=s("3a7b"),a=s.n(i);a.a},5116:function(e,t,s){e.exports=s.p+"img/leaderboard-crown.d1fd4998.svg"},"56c9":function(e,t,s){"use strict";var i=s("2742"),a=s.n(i);a.a},"56d7":function(e,t,s){"use strict";s.r(t);s("e260"),s("e6cf"),s("cca6"),s("a79d");var i,a=s("a026"),r=s("8aa5"),n=s.n(r),o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"app"}},[i("div",{staticClass:"content"},[e.betaMode?i("div",{staticClass:"corner-ribbon bottom-right sticky blue"},[e._v(" Beta ")]):e._e(),i("b-navbar",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{toggleable:"md",type:"dark",variant:e.navbarVariant}},[i("b-navbar-toggle",{attrs:{target:"nav_collapse"}}),i("b-navbar-brand",{attrs:{to:"/",id:"brandName"}},[e._v(e._s(e.brandName))]),i("b-collapse",{attrs:{"is-nav":"",id:"nav_collapse"}},[i("b-navbar-nav",{attrs:{id:"navLinks"}},[i("b-nav-item",{attrs:{to:{name:"Home",query:e.routerQuery},exact:""}},[e._v("Home")]),i("b-nav-item",{attrs:{to:{name:"Leaderboard",query:e.routerQuery}}},[e._v("Leaderboard")]),i("b-nav-item",{attrs:{to:{name:"Play",query:e.routerQuery}}},[e._v("Play")]),i("b-nav-item",{attrs:{to:{name:"Chats",query:e.routerQuery}}},[e._v("Chats")]),e.needsTutorial?i("b-nav-item",{attrs:{to:{name:"Tutorial",query:e.routerQuery}}},[e._v("Tutorial")]):e._e(),e.userData.admin?i("b-nav-item",{attrs:{to:{name:"Admin",query:e.routerQuery}}},[e._v("Admin")]):e._e()],1),i("b-navbar-nav",{staticClass:"ml-auto"},[e.userIsDefined?i("b-nav-item-dropdown",{attrs:{right:""}},[i("template",{slot:"button-content"},[i("em",[e._v(e._s(e.userInfo.displayName))])]),i("b-dropdown-item",{attrs:{to:{name:"Profile",query:e.routerQuery}}},[e._v("Profile")]),i("b-dropdown-item",{on:{click:e.logout}},[e._v("Signout")])],2):i("b-nav-item",{attrs:{to:{name:"Login",query:e.routerQuery}}},[e._v("Login")]),e.userIsDefined?i("b-nav-text",[e.currentLevel.img?i("b-img",{staticClass:"m-1",attrs:{rounded:"circle",width:"20",height:"20",alt:"img",src:e.currentLevel.img}}):e._e(),e._v(" "+e._s(e.userData.score)+" ")],1):e._e()],1)],1)],1),i("nav",[i("ul",{staticClass:"navRoot"},[i("li",{staticClass:"navSection main-logo"},[i("router-link",{attrs:{to:"/"}},[i("img",{attrs:{src:s("b81c"),alt:"Swipes for Science logo"}})])],1),i("li",{staticClass:"navSection mobile-menu"},[i("SliderMenu",{attrs:{needsTutorial:!0,isAdmin:!1}})],1),i("li",{staticClass:"navSection account-details"},[i("AccountMenu",{attrs:{userInfo:e.userInfo,loggedIn:e.userIsDefined},on:{logout:e.logout}})],1),i("li",{staticClass:"navSection desktop-menu"})])]),i("div",{staticClass:"router"},[i("router-view",{attrs:{userInfo:e.userInfo,userData:e.userData,allUsers:e.allUsers,levels:e.levels,currentLevel:e.currentLevel,config:e.config,db:e.db,routerQuery:e.routerQuery},on:{taken_tutorial:e.setTutorial}})],1)],1),i("Footer",{attrs:{config:e.config,routerQuery:e.routerQuery},on:{openConfig:e.openConfig}})],1)},u=[],c=(s("d81d"),s("b64b"),s("ac1f"),s("5319"),s("5f5b")),l=s("bc3a"),d=s.n(l),m=s("5f30"),h=s.n(m),p=s("2ef0"),f=s.n(p),g=(s("f9e3"),s("2dd8"),s("1f54"),s("fa6d"),s("6924"),s("f8e9"),s("9f9f"),s("7dc5")),v=g,b=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"slider-menu"},[s("a",{ref:"slider-menu-toggle",staticClass:"slider-menu__toggle",on:{click:function(t){return e.toggleMenu()}}},[s("svg",{staticStyle:{"fill-rule":"evenodd","clip-rule":"evenodd","stroke-linecap":"round"},attrs:{width:"31px",height:"22px",viewBox:"0 0 31 22",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","xml:space":"preserve","xmlns:serif":"http://www.serif.com/"}},[s("g",{attrs:{transform:"matrix(1,0,0,1,-26.8461,-27.8461)"}},[s("path",{staticStyle:{fill:"none",stroke:"rgb(88,65,171)","stroke-width":"2.5px"},attrs:{d:"M52,33L32,33M47,44L32,44"}})])])]),e.isActive?s("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:{exclude:["slider-menu-toggle"],handler:"onClose"},expression:"{ exclude: ['slider-menu-toggle'], handler: 'onClose' }"}],staticClass:"slider-menu__drawer"},[s("ul",e._l(e.menuItems,(function(t){return s("li",{key:t.name},[s("router-link",{attrs:{to:t.path}},[e._v(e._s(t.name))])],1)})),0)]):e._e()])},y=[],w=(s("4160"),s("159b"),{bind:function(e,t,s){i=function(i){i.stopPropagation();var a=t.value,r=a.handler,n=a.exclude,o=!1;n.forEach((function(e){if(!o){var t=s.context.$refs[e];o=t.contains(i.target)}})),e.contains(i.target)||o||s.context[r]()},document.addEventListener("click",i),document.addEventListener("touchstart",i)},unbind:function(){document.removeEventListener("click",i),document.removeEventListener("touchstart",i)}}),_=w,S={name:"SliderMenu",data:function(){return{isActive:!1,menuItems:[{path:"/",name:"Home"},{path:"/leaderboard",name:"Leaderboard"},{path:"/chats",name:"Chats"},{path:"/play",name:"Play"},{path:"/admin",name:"Admin"},{path:"/tutorial",name:"Tutorial"}]}},props:{needsTutorial:{type:Boolean,required:!0},isAdmin:{type:Boolean,required:!0}},methods:{onClose:function(){this.isActive=!1},toggleMenu:function(){this.isActive=!this.isActive}},directives:{ClickOutside:_},watch:{$route:function(){this.isActive=!1}}},C=S,k=(s("4bc9"),s("2877")),x=Object(k["a"])(C,b,y,!1,null,null,null),I=x.exports,T=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"account-menu"},[e.loggedIn?i("div",{ref:"account-menu-toggle",on:{click:e.toggleMenu}},[i("img",{staticClass:"avatar",attrs:{src:s("95a6"),alt:"Profile Avatar"}}),i("div",{staticClass:"account-menu__user-information"},[i("span",{staticClass:"username"},[e._v(e._s(e.userInfo.displayName))]),i("span",{staticClass:"user-score"},[e._v("99999 points")])])]):i("ul",[i("li",[i("router-link",{staticClass:"nav__link",attrs:{to:"/login"}},[i("i",{staticClass:"fa fa-user",attrs:{"aria-hidden":"true"}}),e._v(" Login ")])],1)]),e.isActive?i("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:{exclude:["account-menu-toggle"],handler:"onClose"},expression:"{ exclude: ['account-menu-toggle'], handler: 'onClose' }"}],staticClass:"account-menu__dropdown"},[i("ul",[i("li",[e._v("Profile")]),i("li",[i("span",{on:{click:e.onClickLogout}},[e._v("Sign out")])])])]):e._e()])},P=[],O={name:"AccountMenu",data:function(){return{isActive:!1}},props:{loggedIn:{type:Boolean,required:!0},userInfo:{type:Object,required:!0}},methods:{onClose:function(){this.isActive=!1},toggleMenu:function(){this.isActive=!this.isActive},onClickLogout:function(){this.$emit("logout")}},directives:{ClickOutside:_},watch:{$route:function(){this.isActive=!1}}},j=O,E=(s("2497"),Object(k["a"])(j,T,P,!1,null,null,null)),q=E.exports,L=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("footer",[i("div",{staticClass:"footer__container"},[i("img",{staticClass:"logo",attrs:{src:s("b81c"),alt:"Swipes for science logo"}}),i("img",{staticClass:"logo",attrs:{src:s("7968"),alt:"eLife logo"}}),i("nav",e._l(e.menuItems,(function(t){return i("router-link",{key:t.name,staticClass:"nav__link",attrs:{to:t.path}},[e._v(e._s(t.name))])})),1),i("div",{staticClass:"configureButton"},[i("b-button",{attrs:{variant:"info"},on:{click:e.openConfig}},[i("i",{staticClass:"fa fa-wrench",attrs:{"aria-hidden":"true"}}),e._v(" Configure ")])],1)])])},A=[],M={name:"Footer",props:{config:{type:Object,required:!0},routerQuery:{type:Object,required:!0}},data:function(){return{menuItems:[{path:"/",name:"Home"},{path:"/play",name:"Game"},{path:"/chats",name:"Chat"},{path:"/tutorial",name:"Tutorial"},{path:"/leaderboard",name:"Leaderboard"},{path:"/about",name:"About"},{path:"/contact",name:"Contact us"}]}},methods:{openConfig:function(e){e.preventDefault(),this.$emit("openConfig")}}},U=M,D=(s("7608"),Object(k["a"])(U,L,A,!1,null,"4d6e0097",null)),N=D.exports;a["default"].use(h.a),a["default"].use(c["a"]),window.firebase=n.a;var $={name:"app",data:function(){return{userInfo:{},db:n.a.database(),config:v,showConfig:!1,allUsers:[],configurationState:{step:0},showHeader:!1}},mounted:function(){this.userInfo=n.a.auth().currentUser;var e=this;n.a.auth().onAuthStateChanged((function(t){e.userInfo=t||{}}))},components:{Footer:N,SliderMenu:I,AccountMenu:q},firebase:function(){return{allUsers:{source:this.db.ref("/users/").orderByChild("score"),asObject:!0}}},watch:{firebaseKeys:function(e){var t=this;n.a.auth().signOut().then((function(){t.userInfo={},n.a.app().delete().then((function(){n.a.initializeApp(e),t.db=n.a.database(),t.db.ref("/users/").orderByChild("score").on("value",(function(e){t.allUsers=e.val()})),t.userInfo=n.a.auth().currentUser||{};var s=t;n.a.auth().onAuthStateChanged((function(e){s.userInfo=e||{}}))}))}))}},computed:{firebaseKeys:function(){return this.config.firebaseKeys},brandName:function(){return this.config.home.title},betaMode:function(){return this.config.betaMode},needsTutorial:function(){return this.config.needsTutorial},navbarVariant:function(){return this.config.app&&this.config.app.navbarVariant||"info"},userData:function(){var e=this,t={};return null==this.userInfo?t:Object.keys(this.userInfo).length?(f.a.map(this.allUsers,(function(s,i){i===e.userInfo.displayName&&(t=s,t[".key"]=i)})),t):t},levels:function(){return this.config.levels},currentLevel:function(){var e=this,t={};return f.a.mapValues(this.levels,(function(s){e.userData.score>=s.min&&e.userData.score<=s.max&&(t=s)})),t},userIsDefined:function(){return null!=this.userInfo&&!!Object.keys(this.userInfo).length},routerQuery:function(){return this.$route.query}},methods:{logout:function(){var e=this;n.a.auth().signOut().then((function(){e.userInfo={},e.$router.replace("login")}))},setUser:function(e){this.userInfo=e||{}},setTutorial:function(e){this.db.ref("/users/".concat(this.userInfo.displayName)).child("taken_tutorial").set(e),this.$router.replace("play")},openConfig:function(){this.showConfig=!0},closeConfig:function(){this.showConfig=!1}},created:function(){var e=this;this.$route.query.config&&d.a.get(this.$route.query.config).then((function(t){e.config=t.data})).catch((function(){}))}},F=$,R=(s("034f"),Object(k["a"])(F,o,u,!1,null,null,null)),H=R.exports,B=(s("45fc"),s("b0c0"),s("8c4f")),z=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"about"}},[s("h1",[e._v("About")]),s("b-container",[s("p",[e._v(" You get points for each sample you annotate. ")]),s("p",[e._v(" You can unlock the following animals based on the number of points you have: ")]),s("b-container",{staticClass:"p-4",attrs:{fluid:""}},[s("b-row",e._l(e.levels,(function(t){return s("b-col",{key:t.level},[s("div",[s("b-img",{staticClass:"pokemon",attrs:{fluid:"",src:t.img_grey,alt:"Thumbnail"}}),s("br"),e._v(" Level "+e._s(t.level)+" "),s("br"),s("span",[e._v(e._s(t.min)+" points")])],1)])})),1)],1)],1)],1)},Q=[],Y={name:"about",data:function(){return{}},props:{levels:{type:Object,required:!1}}},W=Y,G=(s("b8ab"),Object(k["a"])(W,z,Q,!1,null,null,null)),V=G.exports,K=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"admin"}},[s("h1",[e._v("Admin")]),s("b-container",["complete"==e.status?s("p",{staticClass:"lead"},[e._v(" You have "+e._s(e.sampleCounts.length)+" items currently ")]):e._e(),"json"===e.manifestType?s("p",[s("b",[e._v("Data Source:")]),s("a",{attrs:{href:e.config.manifestUrl}},[e._v(e._s(e.config.manifestUrl))])]):"pubmed"===e.manifestType?s("p",[s("b",[e._v("Pubmed Query:")]),e._v(" "+e._s(e.config.manifestQuery)+" ")]):"github"===e.manifestType?s("p",[s("b",[e._v("Github User:")]),e._v(" "+e._s(e.config.manifestGitHub.user)+" "),s("br"),s("b",[e._v("Github Repo:")]),e._v(" "+e._s(e.config.manifestGitHub.repo)+" "),s("br"),s("b",[e._v("Github Path:")]),e._v(" "+e._s(e.config.manifestGitHub.path)+" "),s("br")]):"S3"===e.manifestType?s("p",[s("b",[e._v("S3 bucket:")]),e._v(" "+e._s(e.config.manifestS3.bucket)+" "),s("br"),s("b",[e._v("prefix:")]),e._v(" "+e._s(e.config.manifestS3.prefix)+" "),s("br"),s("b",[e._v("delimiter:")]),e._v(" "+e._s(e.config.manifestS3.delimiter)+" "),s("br")]):e._e(),s("b-button",{attrs:{variant:"warning"},on:{click:e.previewManifest}},[s("span",[e._v(" Preview ")])]),e.manifestEntries.length?s("div",{staticClass:"mt-3 pt-3"},["json"===e.manifestType?s("small",[e._v(" Here are a few items in your manifest file. There are "+e._s(e.manifestEntries.length)+" items in total ")]):"pubmed"===e.manifestType?s("small",[e._v(" Here are a few pubmed IDs from your search. There are "+e._s(e.pubmedQueryStore.count)+" items in total. ")]):e._e(),"github"===e.manifestType?s("small",[e._v(" Here are a few items in your manifest file. There are "+e._s(e.manifestEntries.length)+" items in total ")]):e._e(),"S3"===e.manifestType?s("small",[e._v(" Here are a few items in your manifest file. There are "+e._s(e.manifestEntries.length)+" items in total ")]):e._e(),s("textarea",{staticClass:"mt-3 mb-3 ml-3 mr-3 w-100",attrs:{disabled:"",rows:"5"},domProps:{value:e.manifestEntries.slice(0,100)+"..."}})]):e._e(),"complete"==e.status?s("p",{staticClass:"mt-3 pt-3"},[e._v(" Click the button below to sync your firebase database with your manifest. ")]):e._e(),s("div",{staticClass:"mb-3 pb-3"},["complete"==e.status?s("b-button",{on:{click:e.refreshSamples}},[s("span",[e._v(" Refresh Sample List ")])]):s("div",[s("p",[e._v(e._s(e.status)+" "+e._s(e.progress)+" / "+e._s(e.manifestEntries.length))]),s("b-progress",{staticClass:"mb-2",attrs:{value:e.progress,max:e.manifestEntries.length,variant:"info",striped:""}})],1)],1)],1)],1)},J=[],X=(s("99af"),s("4de4"),s("c975"),s("1276"),s("ea06")),Z=s.n(X),ee={name:"admin",data:function(){return{status:"loading...",progress:0,manifestEntries:[],sampleCounts:[],pubmedQueryStore:{},continuation:null}},props:{levels:{type:Object,required:!0},config:{type:Object,required:!0},db:{type:Object,required:!0}},mounted:function(){this.addFirebaseListener()},computed:{manifestType:function(){var e=null;return e=this.config.manifestType?this.config.manifestType:"json",e}},methods:{addFirebaseListener:function(){var e=this;this.db.ref("sampleCounts").once("value",(function(t){e.sampleCounts=f.a.map(t.val(),(function(e,t){return{".key":t,".value":e}})),e.status="complete"}))},xmlParser:function(e){var t=new DOMParser,s=t.parseFromString(e,"text/xml");return s},getPubmedQueryPreview:function(){var e=this,t="https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi",s="".concat(t,"?db=pubmed&term=").concat(encodeURI(this.config.manifestQuery),"&usehistory=y&retmax=100");return d.a.get(s).then((function(t){var s=e.xmlParser(t.data),i=s.getElementsByTagName("WebEnv")[0],a=s.getElementsByTagName("Count")[0],r=s.getElementsByTagName("IdList")[0].children;e.pubmedQueryStore.webEnv=i.innerHTML,e.pubmedQueryStore.count=a.innerHTML,e.manifestEntries=f.a.map(r,(function(e){return e.innerHTML}))}))},getPubmedQueryFull:function(){var e=this,t="https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi";if(this.pubmedQueryStore.webEnv){var s="".concat(t,"?db=pubmed&term=").concat(encodeURI(this.config.manifestQuery),"&usehistory=y&retmax=").concat(this.pubmedQueryStore.count,"&WebEnv=").concat(this.pubmedQueryStore.webEnv);d.a.get(s).then((function(t){var s=e.xmlParser(t.data),i=s.getElementsByTagName("IdList")[0].children;e.manifestEntries=f.a.map(i,(function(e){return e.innerHTML})),e.syncEntries()}))}else this.getPubmedQueryPreview().then((function(){e.getPubmedQueryFull()}))},getGithubManifest:function(){var e=this,t="https://api.github.com/repos/".concat(this.config.manifestGitHub.user,"/");return t+="".concat(this.config.manifestGitHub.repo,"/contents/").concat(this.config.manifestGitHub.path),d.a.get(t).then((function(t){e.manifestEntries=f.a.map(t.data,(function(e){return e.name.split(".")[0]}))}))},parseS3:function(e){var t=this,s=this.xmlParser(e),i=s.getElementsByTagName("Key"),a=s.getElementsByTagName("NextContinuationToken"),r=s.getElementsByTagName("IsTruncated")[0].innerHTML;this.continuation="true"===r?encodeURIComponent(a[0].innerHTML):null;var n=f.a.map(i,(function(e){return e.innerHTML})),o=f.a.filter(n,(function(e){return e.replace("".concat(t.config.manifestS3.prefix,"/"),"")})),u=f.a.map(o,(function(e){return e.replace("".concat(t.config.manifestS3.prefix,"/"),"").split(".")[0]}));return u},S3Continuation:function(e){var t=this,s="https://s3-us-west-2.amazonaws.com/".concat(this.config.manifestS3.bucket,"/?list-type=2&");return s+="prefix=".concat(this.config.manifestS3.prefix,"/&max-keys=").concat(this.config.manifestS3.max_keys),s+="&delimiter=".concat(this.config.manifestS3.delimiter),s+="&continuation-token=".concat(e),e?d.a.get(s).then((function(e){var s=t.parseS3(e.data);t.manifestEntries=f.a.uniq(t.manifestEntries.concat(s)),t.continuation&&t.S3Continuation(t.continuation)})):0},getS3Manifest:function(){var e=this,t="https://s3-us-west-2.amazonaws.com/".concat(this.config.manifestS3.bucket,"/?list-type=2&");return t+="prefix=".concat(this.config.manifestS3.prefix,"/&max-keys=").concat(this.config.manifestS3.max_keys),t+="&delimiter=".concat(this.config.manifestS3.delimiter),d.a.get(t).then((function(t){var s=e.parseS3(t.data);e.manifestEntries=f.a.uniq(e.manifestEntries.concat(s)),e.continuation&&e.S3Continuation(e.continuation)}))},previewManifest:function(){var e=this;"json"===this.manifestType?d.a.get(this.config.manifestUrl).then((function(t){e.manifestEntries=t.data})):"pubmed"===this.manifestType?this.getPubmedQueryPreview():"github"===this.manifestType?this.getGithubManifest():"S3"===this.manifestType&&this.getS3Manifest()},refreshSamples:function(){var e=this;this.status="refreshing","json"===this.manifestType?d.a.get(this.config.manifestUrl).then((function(t){var s=t.data;e.manifestEntries=s,e.syncEntries()})):"pubmed"===this.manifestType?this.getPubmedQueryFull():"github"===this.manifestType?this.getGithubManifest().then((function(){e.syncEntries()})):"S3"===this.manifestType&&(this.manifestEntries.length?this.syncEntries():(alert("please press the preview button first, and wait to get the final count"),this.status="complete"))},syncEntries:function(){var e=this,t=f.a.map(this.sampleCounts,(function(e){return e[".key"]})),s=this,i=new Z.a;i.postMessage([this.manifestEntries,t,s.config.firebaseKeys]),i.onmessage=function(e){s.status="complete","done"===e.data?s.addFirebaseListener():s.progress+=1},f.a.map(t,(function(t){e.manifestEntries.indexOf(t)<0&&e.db.ref("sampleCounts").child(t).remove()}))}}},te=ee,se=Object(k["a"])(te,K,J,!1,null,null,null),ie=se.exports,ae=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"home container"},[s("div",{staticClass:"jumbotron landing",style:e.landingStyle},[s("h1",{staticClass:"p-1"},[e._v(e._s(e.title))]),s("p",{staticClass:"lead buttons p-1 mt-3"},[e._v(" "+e._s(e.tagline)+" ")]),s("p",{staticClass:"buttons mt-3"},[s("router-link",{staticClass:"btn btn-primary white mx-1",attrs:{to:{name:"Play",query:e.routerQuery}}},[e._v(" Play Now ")]),s("router-link",{staticClass:"btn btn-primary white mx-1",attrs:{to:{name:"Tutorial",query:e.routerQuery}}},[e._v(" Tutorial ")])],1)])])},re=[],ne={name:"Home",props:{config:{type:Object,required:!0},routerQuery:{type:Object}},data:function(){return{}},computed:{title:function(){return this.config.home.title},tagline:function(){return this.config.home.tagline},landingStyle:function(){return{"background-image":'url("'.concat(this.config.home.backgroundUrl,'")')}}}},oe=ne,ue=(s("7437"),Object(k["a"])(oe,ae,re,!1,null,"08d471db",null)),ce=ue.exports,le=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"profile"}},[s("b-container",{attrs:{fluid:""}},[s("h1",[e.currentLevel.img?s("b-img",{staticClass:"m-1",attrs:{rounded:"circle",width:"75",height:"75","blank-color":"#777",alt:"img",src:e.currentLevel.img}}):e._e(),e._v(" "+e._s(e.userInfo.displayName)+" ")],1),s("p",{staticClass:"lead"},[e._v("You have "+e._s(e.userData.score)+" points!")]),s("hr"),s("h3",[e._v("Level "+e._s(e.currentLevel.level))]),s("p",{staticClass:"lead"},[e._v(" Keep playing to unlock the remaining animals! ")]),s("b-container",{staticClass:"p-4",attrs:{fluid:""}},[s("b-row",e._l(e.levels,(function(t){return s("b-col",{key:t.min},[s("div",[t.level<=e.currentLevel.level?s("b-img",{staticClass:"pokemon",attrs:{fluid:"",src:t.img,alt:"Thumbnail"}}):s("b-img",{staticClass:"pokemon",attrs:{fluid:"",src:t.img_grey,alt:"Thumbnail"}}),s("br"),e._v(" Level "+e._s(t.level)+" "),s("br"),t.level>e.currentLevel.level?s("span",[e._v(e._s(t.min)+" points")]):e._e()],1)])})),1)],1),s("hr"),e.chats.length?s("div",[s("h2",[e._v("Your Chats")]),s("p",{staticClass:"lead"},[e._v(" Your discussions on specific samples ")]),e._l(e.chats,(function(t){return s("div",{key:t,staticClass:"text-left"},[e.chatInfo[t]?s("div",[s("b-alert",{attrs:{show:e.chatInfo[t].notify}},[s("router-link",{attrs:{to:"/listen/"+t}},[e._v(e._s(t))]),e._v(": "),s("b",[e._v(e._s(e.chatInfo[t].username))]),e._v(" "+e._s(e.chatInfo[t].message)+" ")],1),s("b-alert",{attrs:{show:!e.chatInfo[t].notify,variant:"light"}},[s("router-link",{attrs:{to:"/review/"+t}},[e._v(e._s(t))]),e._v(": "),s("b",[e._v(e._s(e.chatInfo[t].username))]),e._v(" "+e._s(e.chatInfo[t].message)+" ")],1)],1):e._e()])}))],2):s("div",[s("h2",[e._v("Chats")]),s("p",{staticClass:"lead"},[e._v(" You haven't said anything yet! When you're ready, join the discussion. ")]),s("img",{staticClass:"blankImage",attrs:{src:e.blankImage}})])],1)],1)},de=[],me={name:"profile",data:function(){return{chats:[],chatInfo:{}}},computed:{blankImage:function(){return this.config.profile.blankImage}},props:{userInfo:{type:Object,required:!0},userData:{type:Object,required:!0},levels:{type:Object,required:!0},currentLevel:{type:Object,required:!0},config:{type:Object,required:!0},db:{type:Object,required:!0}},mounted:function(){this.userData[".key"]&&this.getUserChats()},watch:{userData:function(){this.userData[".key"]&&this.getUserChats()},chats:function(){var e=this;this.chats.forEach((function(t){e.db.ref("chats").child("sampleChats").child(t).orderByKey().limitToLast(1).on("value",(function(s){var i=s.val();e.chatInfo[t]=i[Object.keys(i)[0]],e.getNotifications(t),e.$forceUpdate()}))}))}},methods:{getUserChats:function(){var e=this;this.db.ref("chats").child("userChat").child(this.userData[".key"]).on("value",(function(t){var s=t.val();s&&(e.chats=Object.keys(s))}))},getNotifications:function(e){var t=this;this.db.ref("notifications").child(this.userData[".key"]).child(e).on("value",(function(s){s.val()&&(t.chatInfo[e].notify=!0,t.$forceUpdate())}))}}},he=me,pe=(s("1be2"),Object(k["a"])(he,le,de,!1,null,null,null)),fe=pe.exports,ge=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container",attrs:{id:"play"}},[s("b-modal",{ref:"levelUp",attrs:{id:"levelUp",title:"You've Levelled Up!","ok-only":""}},[s("div",{staticClass:"my-4"},[s("h3",[e._v("Level "+e._s(e.currentLevel.level))]),s("img",{attrs:{src:e.currentLevel.img,width:"120px",height:"120px"}}),s("p",{staticClass:"lead"},[e._v("You've unlocked: "+e._s(e.currentLevel.character))])])]),s("div",{staticClass:"main"},[s("b-alert",{staticClass:"toast",attrs:{show:e.dismissCountDown,variant:e.feedback.variant},on:{dismissed:function(t){e.dismissCountdown=0},"dismiss-count-down":e.countDownChanged}},[e._v(" "+e._s(e.feedback.message)+" ")]),e.noData?s("div",[s("h1",[e._v("There is no data in your database!")]),s("p",{staticClass:"lead"},[e._v(" Follow the instructions to set up your SwipesForScience App ")]),s("img",{staticClass:"blankImage",attrs:{src:e.blankImage,alt:"there is no data"}})]):s("div",[e.widgetPointer?s("WidgetSelector",{ref:"widget",attrs:{widgetType:e.widgetType,widgetPointer:e.widgetPointer,widgetProperties:e.widgetProperties,widgetSummary:e.widgetSummary,userSettings:e.userSettings,needsSecret:e.needsSecret,serverSecret:e.serverSecret,playMode:"play"},on:{widgetRating:e.sendWidgetResponse,updateUserSettings:e.updateUserSettings}}):s("div",[s("Flask"),s("p",{staticClass:"mt-3 pt-3 lead"},[e._v("loading...")])],1)],1)],1)],1)},ve=[],be=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"WidgetSelector"},[s("Secret",{attrs:{userSettings:e.userSettings,needsSecret:e.needsSecret,serverSecret:e.serverSecret},on:{updateUserSettings:e.updateUserSettings}},["ImageSwipe"==e.widgetType?s("ImageSwipe",{ref:"ImageSwipe",attrs:{widgetPointer:e.widgetPointer,widgetProperties:e.widgetProperties,widgetSummary:e.widgetSummary,userSettings:e.userSettings,tutorialStep:e.tutorialStep,playMode:e.playMode},on:{widgetRating:e.widgetRating,updateUserSettings:e.updateUserSettings}}):s("TemplateWidget",{ref:"TemplateWidget",attrs:{widgetPointer:e.widgetPointer,widgetProperties:e.widgetProperties,userSettings:e.userSettings,widgetSummary:e.widgetSummary,tutorialStep:e.tutorialStep,playMode:e.playMode},on:{widgetRating:e.widgetRating,updateUserSettings:e.updateUserSettings}})],1)],1)},ye=[],we=(s("a9e3"),function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"imageSwipe"},[s("transition",{key:e.swipe,attrs:{name:e.swipe}},[s("div",{key:e.baseUrl,staticClass:"user-card"},[s("div",{staticClass:"image_area"},[s("progressive-img",{directives:[{name:"hammer",rawName:"v-hammer:swipe.horizontal",value:e.onSwipe,expression:"onSwipe",arg:"swipe",modifiers:{horizontal:!0}}],staticClass:"user-card__picture mx-auto",attrs:{src:e.baseUrl,placeholder:"https://unsplash.it/500","aspect-ratio":1}})],1),s("div",{staticClass:"user-card__name"},[e.playMode?s("b-button",{directives:[{name:"shortkey",rawName:"v-shortkey",value:["arrowleft"],expression:"['arrowleft']"},{name:"hammer",rawName:"v-hammer:swipe.left",value:e.swipeLeft,expression:"swipeLeft",arg:"swipe",modifiers:{left:!0}}],ref:"leftSwipe",staticStyle:{float:"left"},attrs:{variant:"danger"},on:{click:e.swipeLeft,shortkey:e.swipeLeft}},[s("i",{staticClass:"fa fa-long-arrow-left",attrs:{"aria-hidden":"true"}}),e._v(" "+e._s(e.widgetProperties.leftSwipeLabel)+" ")]):s("span",{staticStyle:{float:"left"}},[e.widgetSummary?s("span",[e._v(" ave vote: "+e._s(e.widgetSummary.aveVote||0)+" ")]):s("span",[e._v("ave vote: N/A")])]),e.playMode?s("b-button",{ref:"helpButton",staticClass:"helpbtn",attrs:{to:"/review/"+e.widgetPointer}},[e._v("Help")]):e._e(),e.playMode?s("b-button",{directives:[{name:"shortkey",rawName:"v-shortkey",value:["arrowright"],expression:"['arrowright']"}],ref:"rightSwipe",staticStyle:{float:"right"},attrs:{variant:"success"},on:{click:e.swipeRight,shortkey:e.swipeRight}},[e._v(" "+e._s(e.widgetProperties.rightSwipeLabel)+" "),s("i",{staticClass:"fa fa-long-arrow-right",attrs:{"aria-hidden":"true"}})]):s("span",{staticStyle:{float:"right"}},[e.widgetSummary?s("span",[e._v(" num votes: "+e._s(e.widgetSummary.count||0)+" ")]):s("span",[e._v("num votes: 0")])])],1)])])],1)}),_e=[],Se=s("8ff0"),Ce=s.n(Se),ke=s("9076"),xe=s.n(ke);a["default"].use(xe.a),a["default"].use(s("3717"));var Ie={name:"ImageSwipe",props:{widgetPointer:{type:String,required:!0},widgetProperties:{type:Object,required:!0},widgetSummary:{type:Object,required:!1},userSettings:{type:Object,required:!0},playMode:{type:String,required:!1},tutorialStep:{type:Number,required:!1}},components:{},directives:{imagesLoaded:Ce.a},data:function(){return{status:"loading",swipe:null}},computed:{baseUrl:function(){return this.widgetProperties.baseUrlTemplate&&this.widgetPointer?this.fillPropertyPattern(this.widgetProperties.baseUrlTemplate,this.widgetProperties.delimiter):null}},mounted:function(){var e=this;this.$nextTick((function(){"tutorial"===e.playMode&&e.showTutorialStep(e.tutorialStep)}))},methods:{showTutorialStep:function(e){switch(e){case 0:this.$refs.rightSwipe.classList.add("focus");break;case 1:this.$refs.leftSwipe.classList.add("focus");break;case 2:this.$refs.helpButton.classList.add("focus");break;default:break}},fillPropertyPattern:function(e,t){var s=e,i=String(this.widgetPointer).split(t);return f.a.map(i,(function(e,t){s=s.replace("{".concat(t,"}"),e)})),s},getScore:function(e){var t=this.getFeedback(e);return"danger"===t.variant?0:1},getFeedback:function(e){var t;if(t=this.widgetSummary?this.widgetSummary:{count:0},t.count>4){var s=t.aveVote;return s>=.7&&!e?{show:!1,variant:"danger",message:"+0 most people swiped right"}:s<=.3&&e?{show:!1,variant:"danger",message:"+0 most people swiped left"}:{show:!0,variant:"success",message:"+1 good job"}}return{show:!0,variant:"success",message:"+1 thanks"}},getSummary:function(e){if(!this.widgetSummary)return{aveVote:e,count:1};var t=this.widgetSummary.aveVote*this.widgetSummary.count+e;return t/=this.widgetSummary.count+1,{aveVote:t,count:this.widgetSummary.count+1}},vote:function(e){this.$emit("widgetRating",e)},getPropertiesSchema:function(){return{baseUrlTemplate:{type:String,required:!0,description:"base url to the image file"},delimiter:{type:String,required:!1,default:"__",description:"how to split the sample ID to fill in the template"},leftSwipeLabel:{type:String,required:!1,default:"Fail",description:"label for the left swipe button"},rightSwipeLabel:{type:String,required:!1,default:"True",description:"label for the right swipe button"}}},swipeLeft:function(){this.setSwipe("swipe-left"),this.vote(0)},swipeRight:function(){this.setSwipe("swipe-right"),this.vote(1)},onSwipe:function(e){2===e.direction?this.swipeLeft():this.swipeRight()},setSwipe:function(e){this.swipe=e},test:function(){return this.getScore(1),this.getScore(0),this.getFeedback(1),this.getFeedback(0),this.getSummary(1),this.getSummary(0),this.vote(1),"play"===this.playMode&&(this.showTutorialStep(0),this.showTutorialStep(1),this.showTutorialStep(2)),this.swipeLeft(),this.swipeRight(),this.onSwipe({direction:1}),this.onSwipe({direction:2}),this.setSwipe("swipe-left"),this.getPropertiesSchema(),1}}},Te=Ie,Pe=(s("9dd0"),Object(k["a"])(Te,we,_e,!1,null,"222a4f4c",null)),Oe=Pe.exports,je=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"widgetTemplate"},[s("p",{staticClass:"lead mb-3 pb-3 mt-3 pt-3"},[e._v(e._s(e.widgetPointer))]),e.playMode?e._e():s("p",{staticClass:"mb-3 pb-3 mt-3 pt-3"},[e._v(e._s(e.widgetSummary))]),e.playMode?s("div",{staticClass:"row"},[s("b-btn",{staticClass:"mx-auto ml-3 mr-3",attrs:{variant:"danger"},on:{click:function(t){return e.vote(0)}}},[e._v("Vote No")]),s("b-btn",{staticClass:"mx-auto ml-3 mr-3",attrs:{variant:"info",to:"/review/"+e.widgetPointer}},[e._v("Help")]),s("b-btn",{staticClass:"mx-auto ml-3 mr-3",attrs:{variant:"success"},on:{click:function(t){return e.vote(1)}}},[e._v("Vote Yes")])],1):e._e()])},Ee=[],qe={name:"TemplateWidget",props:{widgetPointer:{type:String,required:!0},widgetProperties:{type:Object,required:!0},widgetSummary:{type:Object,required:!1},userSettings:{type:Object,required:!0},playMode:{type:String,required:!1},tutorialStep:{type:Number,required:!1}},data:function(){return{}},methods:{getScore:function(e){return e?1:0},getFeedback:function(e){return e?{show:!0,variant:"success",message:"good job"}:{show:!0,variant:"danger",message:"bad job"}},getSummary:function(e){if(!this.widgetSummary)return{aveVote:e,count:1};var t=this.widgetSummary.aveVote*this.widgetSummary.count+e;return t/=this.widgetSummary.count+1,{aveVote:t,count:this.widgetSummary.count+1}},vote:function(e){this.$emit("widgetRating",e)},getPropertiesSchema:function(){return{}},test:function(){return this.getScore(1),this.getScore(0),this.getFeedback(1),this.getFeedback(0),this.getSummary(1),this.getSummary(0),this.vote(1),this.getPropertiesSchema(),1}}},Le=qe,Ae=Object(k["a"])(Le,je,Ee,!1,null,null,null),Me=Ae.exports,Ue=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"widgetSecret"},[!e.passesSecret&&e.needsSecret?s("div",{staticClass:"mx-auto",attrs:{id:"signupForm"}},[e.userSettings.secret?s("div",[s("b-alert",{attrs:{variant:"danger",show:""}},[e._v(" Oh no! You didn't enter the right secret! Try again. ")])],1):e._e(),s("p",{staticClass:"lead mb-3 pb-3 mt-3 pt-3"},[s("b-form",{on:{submit:e.onSubmit}},[s("b-form-group",{attrs:{id:"secretInputGroup",label:"Secret:","label-for":"secret"}},[s("b-form-input",{attrs:{id:"secret",type:"text",required:"",placeholder:"Enter Secret"},model:{value:e.form.secret,callback:function(t){e.$set(e.form,"secret",t)},expression:"form.secret"}})],1),s("b-button",{attrs:{type:"submit",variant:"primary"},on:{click:e.onSubmit}},[e._v("Submit")])],1)],1)]):e.passesSecret||!e.needsSecret?s("div",[e._t("default")],2):e._e()])},De=[],Ne=s("5530"),$e={name:"SecretWidget",props:{userSettings:{type:Object,required:!0},needsSecret:{type:Boolean,required:!1,default:!1},serverSecret:{type:String,required:!1}},data:function(){return{form:{secret:null}}},computed:{passesSecret:function(){return this.needsSecret&&this.userSettings.secret?btoa(this.userSettings.secret)===this.serverSecret:!this.needsSecret}},methods:{onSubmit:function(e){e.preventDefault();var t=Object(Ne["a"])({},this.userSettings);t.secret=this.form.secret,this.$emit("updateUserSettings",t)}}},Fe=$e,Re=Object(k["a"])(Fe,Ue,De,!1,null,null,null),He=Re.exports,Be={name:"WidgetSelector",props:{widgetType:{type:String,required:!0},widgetPointer:{type:String,required:!0},widgetProperties:{type:Object,required:!0},userSettings:{type:Object,required:!0},widgetSummary:{type:Object,required:!1},playMode:{type:String,required:!1},tutorialStep:{type:Number,required:!1},needsSecret:{type:Boolean,required:!1},serverSecret:{type:String,required:!1}},components:{ImageSwipe:Oe,TemplateWidget:Me,Secret:He},methods:{getFeedback:function(e){return this.$refs[this.widgetType].getFeedback(e)},getScore:function(e){return this.$refs[this.widgetType].getScore(e)},getSummary:function(e){return this.$refs[this.widgetType].getSummary(e)},widgetRating:function(e){this.$emit("widgetRating",e)},updateUserSettings:function(e){this.$emit("updateUserSettings",e)}}},ze=Be,Qe=Object(k["a"])(ze,be,ye,!1,null,null,null),Ye=Qe.exports,We=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"flask"}},[s("div",{staticClass:"background"}),s("svg",{attrs:{version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 113 130","xml:space":"preserve"}},[s("g",[s("path",{attrs:{fill:"#FFFFFF",d:"M0,0v130h112.084L111.75,0H0z M94.75,128C71,128,56,128,56,128s-14.873,0-38.623,0s-13.945-19.422-6.33-35.945S40,41.25,40,41.25V3h16h11v38.25c0,0,23.901,34.283,31.517,50.805S118.5,128,94.75,128z"}}),s("path",{attrs:{fill:"none",stroke:"#000000","stroke-width":"3","stroke-miterlimit":"10",d:"M56,127.5c0,0-14.873,0-38.623,0s-13.695-19.172-6.08-35.695C18.912,75.283,40.5,41.25,40.5,41.25V2.5h-9H56h19.5h-8v38.75c0,0,23.651,34.033,31.267,50.555c7.615,16.523,19.733,35.695-4.017,35.695S56,127.5,56,127.5z"}})])]),s("div",{staticClass:"bubble b0"}),s("div",{staticClass:"bubble b1"}),s("div",{staticClass:"bubble b2"}),s("div",{staticClass:"bubble b3"}),s("div",{staticClass:"bubble b4"}),s("div",{staticClass:"bubble b5"}),s("div",{staticClass:"bubble b6"}),s("div",{staticClass:"bubble b7"}),s("div",{staticClass:"bubble b8"}),s("div",{staticClass:"bubble b9"}),s("div",{staticClass:"swirl s0"}),s("div",{staticClass:"swirl s1"}),s("div",{staticClass:"swirl s2"}),s("div",{staticClass:"swirl s3"}),s("div",{staticClass:"swirl s4"}),s("div",{staticClass:"swirl s5"})])},Ge=[],Ve={name:"flask"},Ke=Ve,Je=(s("080e"),Object(k["a"])(Ke,We,Ge,!1,null,"3c24b5a6",null)),Xe=Je.exports;a["default"].component("WidgetSelector",Ye);var Ze={name:"play",props:{userInfo:{type:Object,required:!0},userData:{type:Object,required:!0},levels:{type:Object,required:!0},currentLevel:{type:Object,required:!0},config:{type:Object,required:!0},db:{type:Object,required:!0}},data:function(){return{startTime:null,dismissSecs:1,dismissCountDown:0,feedback:{variant:"warning",message:""},status:"loading",sampleCounts:[],userSeenSamples:[],noData:!1,widgetPointer:null,widgetSummary:{},userSettings:{},serverSecret:""}},watch:{currentLevel:function(){this.userData.score===this.currentLevel.min&&this.currentLevel.min&&(this.$refs.levelUp.show(),this.db.ref("/users/".concat(this.userInfo.displayName)).child("level").set(this.currentLevel.level))},widgetPointer:function(){var e=this;this.widgetPointer&&this.db.ref("sampleSummary").child(this.widgetPointer).once("value",(function(t){e.widgetSummary=t.val()}))}},mounted:function(){this.initSampleCounts(),this.initSeenSamples(),this.initUserSettings(),this.fetchServerSecret()},components:{Flask:Xe},computed:{samplePriority:function(){return f.a.sortBy(this.sampleCounts,".value")},blankImage:function(){return this.config.play.blankImage},widgetType:function(){return this.config.widgetType},widgetProperties:function(){return this.config.widgetProperties},needsSecret:function(){return this.config.widgetUsesSecret}},methods:{initUserSettings:function(){var e=this;this.db.ref("userSettings").child(this.userInfo.displayName).on("value",(function(t){var s=t.val();e.userSettings=null==s?{}:s}))},updateUserSettings:function(e){e&&this.db.ref("userSettings").child(this.userInfo.displayName).set(e)},initSampleCounts:function(){var e=this;this.db.ref("sampleCounts").once("value",(function(t){e.sampleCounts=f.a.map(t.val(),(function(e,t){return{".key":t,".value":e}})),e.sampleCounts.length?(e.startTime=new Date,e.setNextSampleId()):e.noData=!0}))},initSeenSamples:function(){var e=this;this.db.ref("userSeenSamples").child(this.userInfo.displayName).once("value",(function(t){e.userSeenSamples=f.a.map(t.val(),(function(e,t){return{".key":t,".value":e}}))}))},shuffle:function(e){var t,s,i=e.length;while(0!==i)s=Math.floor(Math.random()*i),i-=1,t=e[i],e[i]=e[s],e[s]=t;return e},sampleUserPriority:function(){if(this.userInfo){var e;if(this.userSeenSamples){var t=f.a.map(this.userSeenSamples,(function(e){return e[".key"]}));e=f.a.filter(this.samplePriority,(function(e){return t.indexOf(e[".key"])<0})),e=e.length?e:this.samplePriority}else e=this.samplePriority;if(e.length){var s=e[0][".value"],i=f.a.filter(e,(function(e){return e[".value"]===s}));return this.shuffle(i)}return this.shuffle(this.samplePriority)}return null},sendWidgetResponse:function(e){var t=this.$refs.widget.getFeedback(e);t.show&&(this.feedback=t,this.showAlert());var s=new Date-this.startTime;this.sendVote(e,s),this.updateScore(this.$refs.widget.getScore(e)),this.updateSummary(this.$refs.widget.getSummary(e)),this.updateCount(),this.updateSeen(),this.setNextSampleId()},setNextSampleId:function(){this.startTime=new Date;var e=this.sampleUserPriority()[0];e&&(this.widgetPointer=e[".key"])},sendVote:function(e,t){this.db.ref("votes").push({user:this.userInfo.displayName,sample:this.widgetPointer,response:e,time:t})},updateScore:function(e){this.db.ref("users").child(this.userInfo.displayName).child("score").transaction((function(t){return(t||0)+e}))},updateSummary:function(e){this.db.ref("sampleSummary").child(this.widgetPointer).set(e)},updateCount:function(){var e=this;this.db.ref("sampleCounts").child(this.widgetPointer).transaction((function(e){return(e||0)+1})),f.a.map(this.sampleCounts,(function(t){t[".key"]===e.widgetPointer&&(t[".value"]+=1)}))},updateSeen:function(){this.db.ref("userSeenSamples").child(this.userInfo.displayName).child(this.widgetPointer).transaction((function(e){return(e||0)+1})),this.userSeenSamples.push({".key":this.widgetPointer,".value":1})},countDownChanged:function(e){this.dismissCountDown=e},showAlert:function(){this.dismissCountDown=this.dismissSecs},fetchServerSecret:function(){var e=this;this.db.ref("settings").child("secret").once("value").then((function(t){e.serverSecret=t.val()}))}}},et=Ze,tt=(s("7975"),Object(k["a"])(et,ge,ve,!1,null,null,null)),st=tt.exports,it=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"login"}},[s("h1",[e._v("Log In")]),s("div",{staticClass:"container fluid",attrs:{id:"signupForm"}},[s("b-alert",{attrs:{show:e.errors.show,variant:"danger"}},[e._v(e._s(e.errors.message))]),s("b-form",{on:{submit:e.onSubmit}},[s("b-form-group",{attrs:{id:"emailAddressInputGroup",label:"Email address:","label-for":"emailAddress"}},[s("b-form-input",{attrs:{id:"emailAddress",type:"email",required:"",placeholder:"Enter email"},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),s("b-form-group",{attrs:{id:"passwordInputGroup",label:"Password:","label-for":"passwordInput"}},[s("b-form-input",{attrs:{id:"passwordInput",type:"password",required:"",placeholder:"Password"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),s("b-button",{attrs:{type:"submit",variant:"primary"}},[e._v("Submit")])],1),s("p",{staticClass:"mt-3"},[e._v(" Don't have an account? "),s("router-link",{attrs:{to:{name:"SignUp",query:e.routerQuery}}},[e._v("Create one")])],1)],1)])},at=[],rt={name:"login",props:{routerQuery:{type:Object}},data:function(){return{form:{email:null,password:null},errors:{show:!1,message:null}}},methods:{onSubmit:function(e){var t=this;e.preventDefault(),n.a.auth().signInWithEmailAndPassword(this.form.email,this.form.password).then((function(e){t.$emit("login",e),t.$router.push({name:"Play",query:t.routerQuery})}),(function(e){t.errors.show=!0,t.errors.message=e.message}))}}},nt=rt,ot=(s("039a"),Object(k["a"])(nt,it,at,!1,null,null,null)),ut=ot.exports,ct=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"signup"}},[s("h1",[e._v("Sign Up")]),s("b-modal",{ref:"consentform",attrs:{id:"consentform",title:"Consent Form",size:"lg"}},[s("terms"),s("div",{staticClass:"w-100",attrs:{slot:"modal-footer"},slot:"modal-footer"},[s("b-form",{on:{submit:e.saveConsent}},[s("b-button",{attrs:{type:"submit",variant:"primary"}},[e._v("I Consent")])],1)],1)],1),s("div",{staticClass:"container fluid",attrs:{id:"signupForm"}},[s("b-form",{attrs:{validated:""},on:{submit:e.onSubmit}},[s("b-alert",{attrs:{show:e.errors.show,variant:"danger"}},[e._v(e._s(e.errors.message))]),s("b-form-group",{attrs:{id:"consentOpenButton",label:e.consentFormLabel,"label-for":"openConsent"}},[e.form.consented?e._e():s("b-button",{attrs:{variant:"success",id:"openConsent"},on:{click:e.openConsentModal}},[e._v(" Open Consent Form ")])],1),s("b-form-group",{attrs:{id:"emailAddressInputGroup",label:"Email address:","label-for":"emailAddress",description:"We'll never share your email with anyone else."}},[s("b-form-input",{attrs:{id:"emailAddress",type:"email",required:"",placeholder:"Enter email"},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),s("b-form-group",{attrs:{id:"usernameInputGroup",label:"Username:","label-for":"usernameInput",description:"This will be displayed on the leaderboard"}},[s("b-form-input",{attrs:{id:"usernameInput",type:"text",required:"",placeholder:"Choose a username"},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),s("b-form-group",{attrs:{id:"passwordInputGroup",label:"Password:","label-for":"passwordInput"}},[s("b-form-input",{attrs:{id:"passwordInput",type:"password",required:"",placeholder:"Password"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),s("b-form-group",{attrs:{id:"password2InputGroup",label:"Password Again:","label-for":"password2Input"}},[s("b-alert",{attrs:{show:!e.validated,variant:"danger"}},[e._v(" Make sure your passwords match! ")]),s("b-form-input",{attrs:{id:"password2Input",type:"password",required:"",placeholder:"Confirm password"},model:{value:e.form.password2,callback:function(t){e.$set(e.form,"password2",t)},expression:"form.password2"}})],1),s("b-button",{attrs:{type:"submit",variant:"primary",disabled:!e.validated||!e.form.consented}},[e._v("Submit")]),s("p",{staticClass:"mt-3"},[e._v(" Already have an account? "),s("router-link",{attrs:{to:"/login"}},[e._v("Log In")])],1)],1)],1)],1)},lt=[],dt=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},mt=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"terms"}},[s("h4",{staticStyle:{"text-align":"center"}},[e._v(" UNIVERSITY OF WASHINGTON"),s("br"),e._v(" CONSENT FORM ")]),s("h5",{staticStyle:{"text-align":"center"}},[e._v(" Crowdsourcing Quality Control of Diffusion MRI ")]),s("br"),s("h6",[e._v("RESEARCHERS:")]),s("p",[e._v(" Adam Richie-Halford"),s("br"),e._v(" University of Washington eScience Institute"),s("br"),s("a",{attrs:{href:"#"}},[e._v("richford@uw.edu")])]),s("p",[e._v(" Ariel Rokem"),s("br"),e._v(" University of Washington Department of Psychology"),s("br"),s("a",{attrs:{href:"#"}},[e._v("arokem@uw.edu")])]),s("h6",[e._v("RESEARCHER'S STATEMENT:")]),s("p",[e._v(" We are asking you to be in a research study. The purpose of this consent form is to give you the information you will need to help you decide whether to be in the study or not. Please read the form carefully. You may ask questions about the purpose of the research, what we would ask you to do, the possible risks and benefits, your rights as a volunteer, and anything else about the research or this form that is not clear. Please email "),s("a",{attrs:{href:"#"}},[e._v("richford@uw.edu")]),e._v(' if you have any questions. When we have answered all your questions, you can decide if you want to be in the study or not. This process is called "informed consent." ')]),s("h6",[e._v("PURPOSE OF THE STUDY")]),s("p",[e._v(" Image annotation is needed to extract data from images. The purpose of this study is to train better computer algorithms to annotate images, and also correct any errors the computer makes. We aim to 1) collect image annotation data from you, and 2) combine annotations from many users into the most accurate annotation. This information will be used to train new computer algorithms. ")]),s("h6",[e._v("STUDY PROCEDURES")]),s("p",[e._v(" You will be asked to log in. You may be given the option to use an existing social media login (e.g. Twitter, Facebook, Google, etc.), and you may be asked to create an anonymous username to be displayed to the public. You may also choose to include your social media avatar to display alongside your anonymous username in the public leaderboard. Alternatively, you may also have the option to use an anonymous login. You may provide your email when you sign up for an account if you wish to be contacted about future work related to this task. ")]),s("p",[e._v(" You will be given instructions on how to annotate images for a particular task. Try your best to annotate the images as quickly and accurately as you can. You may complete however many tasks you wish. Each task can take anywhere from 30 seconds to 5 minutes. You may stop annotating at any time. ")]),s("p",[e._v(" You may use any device with a web browser (computer, tablet, or phone). We will record all settings you use on the application, your annotations, your screen resolution, and your anonymous username. This data will be made publicly available to researchers. ")]),s("h6",[e._v("RISKS, STRESS, OR DISCOMFORT")]),s("p",[e._v(" Some people feel that providing information for research or having the research session recorded is an invasion of privacy. If you wish to remain anonymous, we recommend creating an anonymous nickname that does not include any identifiers relating to you. ")]),s("h6",[e._v("BENEFITS OF THE STUDY")]),s("p",[e._v(" This study will help us to extract accurate data from images. This information will be used for scientific research. ")]),s("h6",[e._v("CONFIDENTIALITY OF RESEARCH INFORMATION")]),s("p",[e._v(" Your social media login information (such as username and email address), if provided, will remain confidential and will not be shared outside the study team. Government or university staff sometimes review studies such as this one to make sure they are being done safely and legally. If a review of this study takes place, your records may be examined. The reviewers will protect your privacy. The study records will not be used to put you at legal risk of harm. ")]),s("h6",[e._v("RESEARCH-RELATED INJURY")]),s("p",[e._v(" If you think you have been harmed from being in this research, contact Adam Richie-Halford at "),s("a",{attrs:{href:"#"}},[e._v("richford@uw.edu")])]),s("p",[e._v(" * Please note that we cannot ensure the confidentiality of information sent via e-mail. ")]),s("h6",[e._v("SUBJECT’S STATEMENT")]),s("p",[e._v(" This study has been explained to me, and I understand the procedures, benefits, and risks of this study. I affirm that I am capable of consenting on my own behalf, that I am age 18 or older, and I volunteer to take part in this research. I have had a chance to ask questions. If I have questions later about the research, or if I have been harmed by participating in this study, I can contact one of the researchers listed on the first page of this consent form. If I have questions about my rights as a research subject, I can call the Human Subjects Division at (206) 543-0098 or email "),s("a",{attrs:{href:"#"}},[e._v("hsdinfo@uw.edu")]),e._v(". ")])])}],ht={name:"terms",data:function(){return{}}},pt=ht,ft=Object(k["a"])(pt,dt,mt,!1,null,null,null),gt=ft.exports,vt={name:"signup",data:function(){return{form:{email:"",password:"",password2:"",username:"",consented:!1},show:!0,errors:{show:!1,message:null}}},props:{config:{type:Object,required:!0}},components:{terms:gt},computed:{validated:function(){return this.form.password===this.form.password2},consentFormLabel:function(){return this.form.consented?"You have consented!":"Click to read and sign the consent form"}},methods:{onSubmit:function(e){var t=this;e.preventDefault(),n.a.database().ref("users").child(this.form.username).once("value").then((function(e){var s=e.val();s?(t.errors.show=!0,t.errors.message="Username already exists! Please choose a unique username"):t.createAccount()}))},saveConsent:function(e){e.preventDefault(),this.form.consented=!0,this.$refs.consentform.hide()},openConsentModal:function(){this.$refs.consentform.show()},createAccount:function(){var e=this;n.a.auth().createUserWithEmailAndPassword(this.form.email,this.form.password).then((function(t){e.updateProfile(t)}),(function(t){e.errors.show=!0,e.errors.message=t.message}))},insertUser:function(e){n.a.database().ref("users").child(e.displayName).set({score:0,level:0,admin:!1,taken_tutorial:!1,consent:this.form.consented,consentedOn:new Date}).then((function(){})).catch((function(){}))},updateProfile:function(e){var t=this;e.updateProfile({displayName:this.form.username}).then((function(){t.insertUser(e),t.config.needsTutorial?t.$router.replace("tutorial"):t.$router.replace("play")}),(function(e){t.errors.show=!0,t.errors.message=e.message}))}}},bt=vt,yt=(s("56c9"),Object(k["a"])(bt,ct,lt,!1,null,null,null)),wt=yt.exports,_t=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},St=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"unauthorized"}},[s("h1",[e._v("Oops! You are not authorized")]),s("p",[e._v("Please contact the sysadmin to get access to this page")])])}],Ct={name:"unauthorized",data:function(){return{}}},kt=Ct,xt=Object(k["a"])(kt,_t,St,!1,null,null,null),It=xt.exports,Tt=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"page"},[e._m(0),i("div",{staticClass:"page__content grey-gradient-bg"},[i("div",{staticClass:"page__content-container"},[i("div",{staticClass:"leaderboard"},[i("transition-group",{staticClass:"leaderboard__rows",attrs:{tag:"div",name:"list"}},e._l(e.displayUsersList,(function(t,a){return i("div",{key:t.name,staticClass:"leaderboard__row"},[i("div",{staticClass:"leaderboard__row-container"},[i("div",{staticClass:"leaderboard__cell user-index"},[e._v(e._s(a+1))]),i("div",{staticClass:"leaderboard__cell avatar"},[i("div",{staticClass:"avatar"},[i("img",{attrs:{src:s("95a6"),alt:"Swipes for Science logo"}})])]),i("div",{staticClass:"leaderboard__cell username"},[e._v(e._s(t.name))]),0===a?i("div",{staticClass:"leaderboard__cell crown"},[i("img",{attrs:{src:s("5116"),alt:"Medal"}})]):e._e(),i("div",{staticClass:"leaderboard__cell user-score"},[i("div",[e._v(e._s(t.score))])])]),i("hr",{staticClass:"dashed-decorative-line"})])})),0),e.displayLimit<e.sortedUsersList.length?i("button",{staticClass:"full-size-desktop",attrs:{id:"leaderboard__showMore"},on:{click:function(t){return e.showMore()}}},[e._v(" Load more ")]):e._e()],1)])])])},Pt=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"page__header"},[s("h1",[e._v("Leaderboard")])])}],Ot=(s("fb6a"),{name:"leaderboard",props:{levels:{type:Object,required:!0},allUsers:{type:Object,required:!0}},computed:{sortedUsersList:function(){var e=this,t=Object.keys(this.allUsers).filter((function(e){return".key"!==e}));return t=t.map((function(t){return{name:t,score:e.allUsers[t].score}})),t.sort((function(e,t){return t.score-e.score})),t},displayUsersList:function(){return this.sortedUsersList.slice(0,this.displayLimit)}},data:function(){return{sortBy:"score",sortDesc:!0,fields:["rank","badge",{key:".key",label:"Player",sortable:!1},{key:"score",label:"Score",sortable:!0}],displayLimit:10}},methods:{showMore:function(){this.displayLimit=this.displayLimit<this.sortedUsersList.length?Math.min(this.displayLimit+10,this.sortedUsersList.length):this.displayLimit}}}),jt=Ot,Et=(s("f3a5"),Object(k["a"])(jt,Tt,Pt,!1,null,null,null)),qt=Et.exports,Lt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{ref:"tutorial",staticClass:"tutorial"},["Bubbles"==e.backgroundAnimation?s("Bubbles"):e._e(),e._m(0),e.currentBin.bin?s("div",{staticClass:"pbar pt-3 pb-3"},[s("b-progress",{staticClass:"ml-3 mr-3",attrs:{value:e.scrollPosition,max:1,"show-progress":""}})],1):e._e(),e._l(e.steps.intro,(function(t,i){return s("div",{key:i,staticClass:"fullpage"},[s("div",{attrs:{id:"intro"+i}},[s("p",{domProps:{innerHTML:e._s(t.text)}}),s("span",{staticClass:"invisible"},[e._v(e._s(t.text))])]),s("img",{staticClass:"mt-3 pt-3 img",attrs:{src:t.image}})])})),e._l(e.steps.examples,(function(t,i){return s("div",{key:i,staticClass:"fullpage"},[s("div",{staticClass:"text-center message w-100",attrs:{id:"example"+i}},[s("p",{domProps:{innerHTML:e._s(t.text)}}),s("span",{staticClass:"invisible"},[e._v(e._s(t.text))]),t.pointer?s("div",{staticClass:"mt-3"},[s("WidgetSelector",{ref:"widget",refInFor:!0,attrs:{widgetType:e.widgetType,widgetPointer:t.pointer,widgetProperties:e.widgetProperties,widgetSummary:e.widgetSummary,playMode:"tutorial",userSettings:e.userSettings,tutorialStep:t.tutorialStep}})],1):e._e(),t.tutorialCompleted?s("div",[s("b-button",{staticClass:"mt-3",on:{click:e.tutorialComplete}},[e._v("Play now")])],1):e._e()])])})),e.bins.length-1!=e.currentBin.bin?s("div",{directives:[{name:"scroll-to",rawName:"v-scroll-to",value:e.nextStep,expression:"nextStep"}]},[s("Arrow")],1):e._e(),s("p")],2)},At=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("h1",[e._v("Tutorial")]),s("p",{staticClass:"lead"},[e._v("Scroll down to learn how to play")])])}],Mt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("svg",{staticClass:"arrows"},[s("path",{staticClass:"a1",attrs:{d:"M0 0 L30 32 L60 0"}}),s("path",{staticClass:"a2",attrs:{d:"M0 20 L30 52 L60 20"}}),s("path",{staticClass:"a3",attrs:{d:"M0 40 L30 72 L60 40"}})])},Ut=[],Dt={name:"Arrow"},Nt=Dt,$t=(s("6ac8"),Object(k["a"])(Nt,Mt,Ut,!1,null,null,null)),Ft=$t.exports,Rt=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},Ht=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"bg",attrs:{id:"background-wrap"}},[s("div",{staticClass:"bubble x1"}),s("div",{staticClass:"bubble x2"}),s("div",{staticClass:"bubble x3"}),s("div",{staticClass:"bubble x4"}),s("div",{staticClass:"bubble x5"}),s("div",{staticClass:"bubble x6"}),s("div",{staticClass:"bubble x7"}),s("div",{staticClass:"bubble x8"}),s("div",{staticClass:"bubble x9"}),s("div",{staticClass:"bubble x10"})])}],Bt={name:"bubbles"},zt=Bt,Qt=(s("dd79"),Object(k["a"])(zt,Rt,Ht,!1,null,"fdd6d1d8",null)),Yt=Qt.exports,Wt=s("f13c");a["default"].use(Wt,{container:"body",duration:500,easing:"ease",offset:-75,force:!0,cancelable:!0,onStart:!1,onDone:!1,onCancel:!1,x:!1,y:!0});var Gt={name:"tutorial",components:{Arrow:Ft,Bubbles:Yt,WidgetSelector:Ye},data:function(){return{scrollPosition:0,widgetSummary:{},userSettings:{}}},props:{levels:{type:Object,required:!0},config:{type:Object,required:!0}},watch:{},computed:{widgetType:function(){return this.config.widgetType},widgetProperties:function(){return this.config.widgetProperties},steps:function(){return this.config.tutorial.steps},backgroundAnimation:function(){return this.config.tutorial.customBackgroundAnimation},bins:function(){for(var e=this.steps.intro.length+this.steps.examples.length,t=1/e,s=[],i=0;i<e;i+=1)s.push({bin:i,from:i*t,to:(i+1)*t});return s},currentBin:function(){var e=this,t=f.a.filter(this.bins,(function(t){return e.scrollPosition<=t.to&&e.scrollPosition>t.from}));return t.length?t[0]:{bin:0}},currentStage:function(){return this.currentBin.bin<this.steps.intro.length?Object(Ne["a"])(Object(Ne["a"])({},this.steps.intro[this.currentBin.bin]),{},{mode:"intro"}):Object(Ne["a"])(Object(Ne["a"])({},this.steps.examples[this.currentBin.bin-this.steps.intro.length]),{},{mode:"examples"})},nextStep:function(){return this.currentBin.bin<this.steps.intro.length-1?"#intro".concat(this.currentBin.bin+1):"#example".concat(this.currentBin.bin-this.steps.intro.length+1)}},methods:{tutorialComplete:function(){this.$emit("taken_tutorial",!0)},handleScroll:function(){var e=Math.max(document.documentElement.clientHeight,window.innerHeight||0),t=(window.scrollY-60)/(this.$refs.tutorial.clientHeight-e);this.scrollPosition=t<0?0:t>1?1:t}},created:function(){window.addEventListener("scroll",this.handleScroll)},destroyed:function(){window.removeEventListener("scroll",this.handleScroll)}},Vt=Gt,Kt=(s("c061"),Object(k["a"])(Vt,Lt,At,!1,null,null,null)),Jt=Kt.exports,Xt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container",attrs:{id:"review"}},[s("div",{staticClass:"chat container"},[s("h3",{staticClass:"mb-2"},[e._v("Chat")]),e.chatOrder.length?s("div",{staticClass:"chatHistory pl-3 pr-3 pt-3 pb-3 mb-3"},e._l(e.chatOrder,(function(t){return s("p",{key:t.time,staticClass:"text-left"},[s("b",[e._v(e._s(t.username))]),e._v(": "+e._s(t.message)+" ")])})),0):s("div",[s("p",[e._v("No one has said anything yet!")])]),s("b-form",{on:{submit:e.sendChat}},[s("b-form-group",{attrs:{id:"exampleInputGroup1",label:"Enter chat message:","label-for":"exampleInput1",description:""}},[s("b-form-input",{attrs:{id:"exampleInput1",type:"text",required:"",placeholder:"Enter your message"},model:{value:e.chatMessage,callback:function(t){e.chatMessage=t},expression:"chatMessage"}}),s("b-button",{staticClass:"mt-2",attrs:{variant:"primary"},on:{click:e.sendChat}},[e._v("Send")])],1)],1)],1),s("div",[s("WidgetSelector",{ref:"widget",attrs:{widgetType:e.widgetType,widgetPointer:e.widgetPointer,widgetProperties:e.widgetProperties,widgetSummary:e.widgetSummary,userSettings:e.userSettings,playMode:""}})],1)])},Zt=[],es={name:"review",props:{userInfo:{type:Object,required:!0},userData:{type:Object,required:!0},levels:{type:Object,required:!0},currentLevel:{type:Object,required:!0},config:{type:Object,required:!0},db:{type:Object,required:!0}},components:{WidgetSelector:Ye},data:function(){return{widgetPointer:"",widgetSummary:{},userSettings:{},chatMessage:"",chatHistory:[]}},computed:{chatOrder:function(){var e=[];return f.a.mapValues(this.chatHistory,(function(t){e.push(t)})),e.reverse(),e},widgetType:function(){return this.config.widgetType},widgetProperties:function(){return this.config.widgetProperties}},watch:{$route:function(){this.widgetPointer=this.$route.params.key}},mounted:function(){this.widgetPointer=this.$route.params.key,this.setSampleInfo()},methods:{sendChat:function(e){var t=this;e.preventDefault();var s=this.$route.params.key;this.db.ref("chats").child("sampleChats").child(s).push({username:this.userData[".key"],message:this.chatMessage,time:(new Date).toISOString()}),this.db.ref("chats").child("sampleChatIndex").child(s).set({time:(new Date).toISOString()}),this.db.ref("chats").child("userChat").child(this.userData[".key"]).child(s).set({watch:1}),this.chatMessage="";var i=[];this.chatOrder.forEach((function(e){i.indexOf(e.username)<0&&e.username!==t.userData[".key"]&&i.push(e.username)})),i.forEach((function(e){t.db.ref("chats").child("userNotifications").child(e).child(s).set(!0)}))},unravelFirebaseListObject:function(e){var t=[];return f.a.mapValues(e,(function(e){t.push(e)})),t},setSampleInfo:function(){var e=this;this.db.ref("chats").child("sampleChats").child(this.widgetPointer).on("value",(function(t){var s=t.val();e.chatHistory=s})),this.userInfo.displayName&&this.db.ref("userSettings").child(this.userInfo.displayName).once("value").then((function(t){e.userSettings=t.val()||{}})),this.db.ref("sampleSummary").child(this.widgetPointer).on("value",(function(t){e.widgetSummary=t.val()}))}}},ts=es,ss=(s("18ec"),Object(k["a"])(ts,Xt,Zt,!1,null,null,null)),is=ss.exports,as=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("b-container",[e.noData?s("div",[s("h1",[e._v("Chats")]),s("p",{staticClass:"lead"},[e._v("No one has said anything yet!")]),s("img",{staticClass:"blankImage",attrs:{src:e.blankChatImage}})]):s("div",[s("h1",[e._v("Chats")]),s("p",{staticClass:"lead"},[e._v("See which samples people are talking about")]),e._l(e.sampleChat,(function(t,i){return s("p",{key:i},[s("b-alert",{attrs:{show:""}},[s("router-link",{attrs:{to:"/review/"+t[".key"]}},[e._v(e._s(t[".key"]))]),s("br"),e.chatInfo[t[".key"]]?s("span",[s("b",[e._v(e._s(e.chatInfo[t[".key"]].username))]),e._v(" : "+e._s(e.chatInfo[t[".key"]].message)+" ")]):e._e()],1)],1)}))],2)])},rs=[],ns={firebase:function(){return{sampleChat:{source:this.db.ref("chats").child("sampleChatIndex").orderByChild("time"),readyCallback:function(){var e=this;this.sampleChat.forEach((function(t){e.db.ref("chats").child("sampleChats").child(t[".key"]).orderByKey().limitToLast(1).on("value",(function(s){var i=s.val();e.chatInfo[t[".key"]]=i[Object.keys(i)[0]],e.$forceUpdate()}))})),this.sampleChat.length||(this.noData=!0)}}}},data:function(){return{chatInfo:{},noData:!1}},props:{config:{type:Object,required:!0},db:{type:Object,required:!0}},computed:{orderedPosts:function(){var e=this.sampleChat;return e.reverse()},blankChatImage:function(){return this.config.chats.blankImage}}},os=ns,us=(s("6e45"),Object(k["a"])(os,as,rs,!1,null,null,null)),cs=us.exports;a["default"].use(B["a"]);var ls=new B["a"]({scrollBehavior:function(){return{x:0,y:0}},routes:[{path:"*",redirect:"/login"},{path:"/",name:"Home",component:ce},{path:"/about",name:"About",component:V},{path:"/profile",name:"Profile",component:fe,meta:{requiresAuth:!0}},{path:"/play",name:"Play",component:st,meta:{requiresAuth:!0}},{path:"/login",name:"Login",component:ut},{path:"/signup",name:"SignUp",component:wt},{path:"/terms",name:"Terms",component:gt},{path:"/unauthorized",name:"Unauthorized",component:It},{path:"/leaderboard",name:"Leaderboard",component:qt},{path:"/tutorial",name:"Tutorial",component:Jt},{path:"/chats",name:"Chats",component:cs,meta:{requiresAuth:!0}},{path:"/review/:key",name:"Review",component:is},{path:"/admin",name:"Admin",component:ie,meta:{requiresAuth:!0,requiresAdmin:!0}}]});ls.beforeEach((function(e,t,s){var i=n.a.auth().currentUser,a=e.matched.some((function(e){return e.meta.requiresAuth})),r=e.matched.some((function(e){return e.meta.requiresAdmin}));a&&!i&&s({path:"/login",query:t.query}),"Play"===e.name&&(i?n.a.database().ref("/users/".concat(i.displayName)).once("value").then((function(e){var i=e.val();!i.taken_tutorial&&v.needsTutorial&&s({path:"/tutorial",query:t.query})})):s({path:"/login",query:t.query})),r?n.a.database().ref("/settings/admins/".concat(i.displayName)).once("value").then((function(e){r&&!e.val()?s("unauthorized"):s()})):s()}));var ds,ms=ls;a["default"].config.productionTip=!1,n.a.initializeApp(v.firebaseKeys),n.a.auth().onAuthStateChanged((function(){ds||(ds=new a["default"]({el:"#app",template:"<App/>",components:{App:H},router:ms}))}))},6924:function(e,t,s){},"6ac8":function(e,t,s){"use strict";var i=s("84ac"),a=s.n(i);a.a},"6e45":function(e,t,s){"use strict";var i=s("d80c"),a=s.n(i);a.a},7155:function(e,t,s){},7174:function(e,t,s){},7437:function(e,t,s){"use strict";var i=s("a1e9"),a=s.n(i);a.a},7608:function(e,t,s){"use strict";var i=s("1949"),a=s.n(i);a.a},7968:function(e,t,s){e.exports=s.p+"img/eLife-logo.4bb380cb.svg"},7975:function(e,t,s){"use strict";var i=s("231f"),a=s.n(i);a.a},"7dc5":function(e){e.exports=JSON.parse('{"needsTutorial":true,"manifestUrl":"https://fibr-gifs.s3-us-west-2.amazonaws.com/md_gif_manifest.json","manifestType":"json","widgetType":"ImageSwipe","widgetProperties":{"baseUrlTemplate":"https://s3-us-west-2.amazonaws.com/fibr-gifs/{0}.gif","delimiter":"__","leftSwipeLabel":"Fail","rightSwipeLabel":"Pass"},"iconAttribute":{"name":"openmoji","url":"http://openmoji.org"},"levels":{"0":{"level":0,"min":0,"max":100,"character":null,"img":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/color/svg/1FAB1.svg?sanitize=true","img_grey":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/black/svg/1FAB1.svg?sanitize=true"},"1":{"level":1,"min":101,"max":350,"character":"fish","img":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/color/svg/1F41F.svg?sanitize=true","img_grey":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/black/svg/1F41F.svg?sanitize=true"},"2":{"level":2,"min":351,"max":750,"character":"frog","img":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/color/svg/1F438.svg?sanitize=true","img_grey":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/black/svg/1F438.svg?sanitize=true"},"3":{"level":3,"min":751,"max":1000,"character":"duck","img":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/color/svg/1F986.svg?sanitize=true","img_grey":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/black/svg/1F986.svg?sanitize=true"},"4":{"level":4,"min":1001,"max":1500,"character":"koala","img":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/color/svg/1F428.svg?sanitize=true","img_grey":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/black/svg/1F428.svg?sanitize=true"},"5":{"level":5,"min":1501,"max":2000,"character":"cat","img":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/color/svg/1F408.svg?sanitize=true","img_grey":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/black/svg/1F408.svg?sanitize=true"},"6":{"level":6,"min":2001,"max":2500,"character":"lion","img":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/color/svg/1F981.svg?sanitize=true","img_grey":"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/black/svg/1F981.svg?sanitize=true"}},"betaMode":false,"firebaseKeys":{"apiKey":"AIzaSyD4M59C_77B8CStJXmRl66jApO3ATRCy7w","authDomain":"fibr-gifs.firebaseapp.com","databaseURL":"https://fibr-gifs.firebaseio.com","projectId":"fibr-gifs","storageBucket":"fibr-gifs.appspot.com","messagingSenderId":"175709005112"},"app":{"navbarVariant":"info"},"home":{"title":"fibr: swipe left on dirty minds","tagline":"A citizen science game to measure the quality of children\'s brain images","backgroundUrl":"https://raw.githubusercontent.com/arokem/2020-10-30-ODSC/master/img/pyafq_segmentation1.gif"},"play":{"blankImage":"https://raw.githubusercontent.com/SwipesForScience/testConfig/master/images/undraw_blank_canvas.svg?sanitize=true"},"chats":{"blankImage":"https://raw.githubusercontent.com/SwipesForScience/testConfig/master/images/undraw_no_data.svg?sanitize=true"},"profile":{"blankImage":"https://raw.githubusercontent.com/SwipesForScience/testConfig/master/images/undraw_chatting.svg?sanitize=true"},"tutorial":{"customBackgroundAnimation":"","steps":{"intro":[{"text":"Most mental health disorders are diagnosed between the ages of 5-20.","image":"https://raw.githubusercontent.com/richford/fibr/master/src/assets/undraw_children_4rtb.svg?sanitize=true"},{"text":"The Healthy Brain Network is collecting brain MRI scans of adolescents with mental health disorders.","image":"https://raw.githubusercontent.com/richford/fibr/master/src/assets/magnetic-resonance-imaging-5366912.svg?sanitize=true"},{"text":"Can brain images help us understand mental health?<br>To find out, scientists need your help to measure the brain and assess the quality of the collected data.","image":"https://raw.githubusercontent.com/richford/fibr/master/src/assets/undraw_medical_research_qg4d.svg?sanitize=true"},{"text":"Here is an animated MRI image of the head (looking from the top down).","image":"https://raw.githubusercontent.com/richford/fibr/master/src/assets/sub-NDARNH170TJU_desc-t1w_optimized.gif"},{"text":"A computer has colored in parts of the brain<br>where it thinks it has found fibers<br>connecting different parts of the brain.","image":"https://raw.githubusercontent.com/richford/fibr/master/src/assets/sub-NDARNH170TJU_desc-colorfa_optimized.gif"}],"examples":[{"text":"But scientists need your help to check whether the computer did a good job.<br>You will see sections of the brain below.<br>Swipe right when the image is of good quality, like this one.","pointer":"sub-NDARNT113YX7_desc-colorfa_slice-1_medium","answer":1,"tutorialStep":0},{"text":"Swipe left when its bad. In this example, there is little to no color in the image.","pointer":"sub-NDARYZ871DXQ_desc-colorfa_slice-0_medium","answer":0,"tutorialStep":1},{"text":"Here\'s another good example. Swipe right!","pointer":"sub-NDARNC287MK5_desc-colorfa_slice-2_medium","answer":1,"tutorialStep":0},{"text":"Something went really wrong here.<br>Swipe left!","pointer":"sub-NDARYF338WW1_desc-colorfa_slice-1_medium","answer":0,"tutorialStep":1},{"text":"This one is also bad.<br>The colors are sparse. They don\'t connect to form fiber bundles.<br>Also the underlying black and white image has a series of dark rings<br>near the top of the image (scientists call this Gibbs ringing).<br>Swipe left!","pointer":"sub-NDARHP924ZHW_desc-colorfa_slice-2_medium","answer":0,"tutorialStep":1},{"text":"Swipe left when there is little or no color in the image.","pointer":"sub-NDARAP782TVC_desc-colorfa_slice-2_medium","answer":0,"tutorialStep":1},{"text":"This one\'s no good either. The colors look fine but look at the image in the background. This participant apparently moved a lot in the scanner. Swipe left!","pointer":"sub-NDARBD341NEM_desc-colorfa_slice-2_medium","answer":0,"tutorialStep":1},{"text":"This one is bad as well.<br>The colored bundles stop abruptly<br>and the underlying grayscale image is of poor quality.<br>Swipe left!","pointer":"sub-NDARGC099LDZ_desc-colorfa_slice-3_medium","answer":0,"tutorialStep":1},{"text":"Swipe left when there is little or no color in the image.","pointer":"sub-NDARBD341NEM_desc-colorfa_slice-0_medium","answer":0,"tutorialStep":1},{"text":"If you\'re not sure, click \'help\' \\n to discuss with scientists.","pointer":"sub-NDARGD425PTN_desc-colorfa_slice-0_medium","answer":2,"tutorialStep":2},{"text":"Are you ready to play?","tutorialCompleted":true}]}}}')},8453:function(e,t,s){},"84ac":function(e,t,s){},"85ec":function(e,t,s){},"89f6":function(e,t,s){},"95a6":function(e,t,s){e.exports=s.p+"img/kesh-profile-icon.13d37edb.svg"},"98e0":function(e,t,s){},"9dd0":function(e,t,s){"use strict";var i=s("7155"),a=s.n(i);a.a},"9f9f":function(e,t,s){},a1e9:function(e,t,s){},b81c:function(e,t,s){e.exports=s.p+"img/swipes-for-science-logo.279e7d6c.svg"},b8ab:function(e,t,s){"use strict";var i=s("98e0"),a=s.n(i);a.a},b946:function(e,t,s){},c061:function(e,t,s){"use strict";var i=s("4906"),a=s.n(i);a.a},c638:function(e,t,s){},d80c:function(e,t,s){},dd79:function(e,t,s){"use strict";var i=s("c638"),a=s.n(i);a.a},ea06:function(e,t,s){e.exports=function(){return new Worker(s.p+"d0268fda84b1b66b74aa.worker.js")}},efb1:function(e,t,s){},f3a5:function(e,t,s){"use strict";var i=s("b946"),a=s.n(i);a.a},f8e9:function(e,t,s){},faf5:function(e,t,s){}});
//# sourceMappingURL=app.bfd6e514.js.map